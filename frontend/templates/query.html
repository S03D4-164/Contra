{% extends "base.html" %}

{% block title %}
<title>Query</title>
{% endblock %}

{% block script %}
<script>
$(document).ready(
        function(){
                $('#job_table').DataTable({"order":[0, 'desc']});
                $('#page_table').DataTable({"order":[0, 'desc']});
        }
);
</script>
{% endblock %}

{% block container %}

<div class="row">

<div id="query" class="col-sm-12">

<div class="panel panel-primary">
<div class="panel-heading">Query</div>
<div class="panel-body">
<table class="table table-striped table-hover ">
<thead><tr>
<th>id</th>
<th>created_at</th>
<th>input</th>
</tr></thead>
<tr>
<td><a class="btn btn-primary" href="/query/{{q.id}}">{{q.id}}</td>
<td>{{q.created_at}}</td>
<td>{{q.input}}</td>
<td>
<form method="post">{% csrf_token %}
<button type="button" class="btn btn-info " data-toggle="modal" data-target="#modal_delete">Delete</button>
</form>
</td>
</tr>
</table>
</div><!--.panel-body-->
</div><!--.panel-->

<div id="modal_delete" class="modal" role="dialog">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal">&times;</button>
<h4 class="modal-title">Delete Query</h4>
</div><!--.modal-header-->
<div class="modal-body">
Are you sure?
<form method="post" action="/query/{{q.id}}" >{% csrf_token %}
<input type="submit" class="btn" name="delete" value="delete">
</form>
</div><!--.modal-body-->
</div><!--.modal-content-->
</div><!--.modal-dialog-->
</div><!--#modal_delete-->


</div><!--.query-->


<div id="job" class="col-sm-4">
<div class="panel panel-primary">
<div class="panel-heading">
Job
</div>
<div class="panel-body">
<table id="job_table" class="table table-striped table-hover">
<thead><tr>
<th>id</th>
<th>created_at</th>
<th>status</th>
</tr></thead>
<tbody>{% for j in job %}
<tr>
<td><a class="btn btn-primary" href="/job/{{j.id}}">{{j.id}}</td>
<td>{{j.created_at}}</td>
<td>{{j.status}}</td>
</tr>
{% endfor %}</tbody>
</table>

</div><!--.panel-body-->

</div><!--panel-->

</div><!--.query-->

<div id="page" class="col-sm-8">

<div class="panel panel-primary">
<div class="panel-heading">
Page
</div>
<div class="panel-body">
<table id="page_table" class="table table-striped table-hover ">
<thead>
<tr>
<th>id</th>
<th>created_at</th>
<th>url</th>
<th>http_status</th>
<th>capture</th>
</tr>
</thead>
<tbody>
{% for p in page %}
<tr>
<td><a class="btn btn-primary" href="/page/{{p.id}}">{{p.id}}</td>
<td>{{p.created_at}}</td>
<td>{{p.url}}</td>
<td>{{p.http_status}}</td>
<td><img src="data:image/png;base64,{{p.capture.b64thumb}}"></td>
</tr>
{% endfor %}
</tbody>
</table>
</div><!--.panel-body-->

</div><!--.panel-->

</div><!--.page-->

</div><!--.row-->

{% endblock %}
